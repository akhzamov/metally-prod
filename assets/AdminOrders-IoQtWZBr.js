import{e as p,f as _,g as h,S as w,r as D,h as m,i as $,c as f,a as r,b as t,w as n,j as x,k as B,F as C,n as N,v as O,o as g,t as a,d as b,u as i,q as T,s as A,x as E,y as L}from"./index-MFRvlJMp.js";/* empty css                        */const P=p("orders",{state:()=>({orders:null,loader:!1}),actions:{async getOrders(d,o){try{this.loader=!0;const s=await h({url:`${_}/orders/?offset=${d}&limit=${o}`,method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("access_token")}`}});this.orders=s.data.orders,console.log(s.data),this.loader=!1}catch(s){console.log(s)}},async changeOrderStatus(d,o){try{this.loader=!0;const s=await h({url:`${_}/orders/${d}?status=${o}`,method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("access_token")}`}});this.loader=!1,w.fire({title:"Статус заказа был изменен!",confirmButtonText:"Окей"}).then(c=>{c.isConfirmed&&(w.fire("Успешно!","","success"),location.reload())})}catch(s){console.log(s)}}}}),V={key:0,class:"admin-orders"},j=r("h2",{class:"admin-orders__title"},"Заказы",-1),F={class:"admin-orders__table"},I={class:"admin-orders__table-open w-full"},z=r("h3",null,"Заказы",-1),M={class:"m-2"},U={class:"m-2"},J={__name:"AdminOrders",setup(d){const o=P(),s=D(!0),c=m(()=>o.orders),v=m(()=>o.loader);return $(()=>{o.getOrders(0,10)}),(q,G)=>{const l=T,u=A,y=N,S=O;return g(),f(C,null,[c.value?(g(),f("div",V,[j,r("div",F,[t(y,{data:c.value,border:s.value,class:"admin-orders__table"},{default:n(()=>[t(l,{type:"expand"},{default:n(e=>[r("div",I,[z,r("p",M,a(e.row.order.metal_category)+" - "+a(e.row.order.metal_subcategory),1),r("p",U,a(e.row.order.metal_price.toLocaleString())+" сум - "+a(e.row.order.amount)+" "+a(e.row.order.unit)+". ",1),r("p",null," Общая сумма заказа: "+a(e.row.total_sum.toLocaleString())+" сум ",1)])]),_:1}),t(l,{prop:"id",label:"ID",width:"170"}),t(l,{prop:"created_at",label:"Дата",width:"170",sortable:""},{default:n(e=>[b(a(new Date(e.row.created_at).getDate())+" / "+a(new Date(e.row.created_at).getMonth())+" / "+a(new Date(e.row.created_at).getFullYear())+" год ",1)]),_:1}),t(l,{prop:"client_name",label:"Клиент",width:"170"}),t(l,{prop:"client_phone",label:"Номер телефона",width:"170"}),t(l,{label:"Состояние",width:"170"},{default:n(e=>[b(a(e.row.status=="New"?"Не Обслужено":e.row.status=="Processed"?"Обслужено":"Отклонено"),1)]),_:1}),t(l,{label:"Операции",width:"110"},{default:n(e=>[t(u,{onClick:k=>i(o).changeOrderStatus(e.row.id,"Processed"),disabled:e.row.status!="New",type:e.row.status!="New"?"info":"success",icon:i(E),circle:""},null,8,["onClick","disabled","type","icon"]),t(u,{onClick:k=>i(o).changeOrderStatus(e.row.id,"Declined"),disabled:e.row.status=="Declined"||e.row.status=="Processed",type:e.row.status=="New"?"danger":"info",icon:i(L),circle:""},null,8,["onClick","disabled","type","icon"])]),_:1})]),_:1},8,["data","border"])])])):x("",!0),B(r("div",null,null,512),[[S,v.value,void 0,{fullscreen:!0,lock:!0}]])],64)}}};export{J as default};
