import{e as I,f as v,g as b,S as m,r as f,h as C,i as L,c as B,a as h,b as t,w as l,j as P,k as z,F as U,n as j,z as N,v as G,o as $,d as _,t as w,u,A as M,q as O,s as q,B as R,C as W,D as H,x as J,G as K}from"./index-MFRvlJMp.js";/* empty css                        */const Q=I("metals",{state:()=>({metals:null,loader:!1}),actions:{async getMetals(){try{this.loader=!0;const i=await b({url:`${v}/metals`,method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("access_token")}`}});this.metals=i.data.metals,console.log(i.data),this.loader=!1}catch(i){console.log(i)}},async updateMetalStatus(i,a){console.log(a);try{this.loader=!0;const d=await b({url:`${v}/metals/${i}`,method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("access_token")}`},data:{available:!!a}});this.loader=!1,m.fire({title:"Статус металла была изменена!",confirmButtonText:"Окей"}).then(n=>{n.isConfirmed&&(m.fire("Успешно!","","success"),location.reload())})}catch(d){console.log(d)}},async updateMetalPrice(i,a){try{this.loader=!0;const d=await b({url:`${v}/metals/${i}`,method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("access_token")}`},data:{price:a}});this.loader=!1,m.fire({title:"Цена металла была изменена!",confirmButtonText:"Окей"}).then(n=>{n.isConfirmed&&(m.fire("Успешно!","","success"),location.reload())})}catch(d){console.log(d)}}}}),X={key:0,class:"admin-metals"},Y=h("h2",{class:"admin-metals__title"},"Металлы",-1),Z={class:"admin-metals__table"},ee={class:"dialog-footer"},le={__name:"AdminMetals",setup(i){const a=Q(),d=f(!0);f(!1);const n=f(!1);let o=f(""),g=f(null);const y=C(()=>a.metals),S=C(()=>a.loader),V=(p,s,r)=>{g.value=p,m.fire({title:`Введите цену для ${s} ${r}`,input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Подтвердить",showLoaderOnConfirm:!0,preConfirm:async c=>{try{return o.value=c}catch{m.showValidationMessage(`
        Ошибка, повторите попытку заново!
      `)}},allowOutsideClick:()=>!m.isLoading()}).then(c=>{c.isConfirmed&&a.updateMetalPrice(g.value,o.value)})};return L(()=>{a.getMetals()}),(p,s)=>{const r=O,c=q,k=j,A=R,E=W,T=H,x=N,D=G;return $(),B(U,null,[y.value?($(),B("div",X,[Y,h("div",Z,[t(k,{data:y.value,border:d.value,class:"admin-metals__table"},{default:l(()=>[t(r,{prop:"id",label:"ID",width:"170"}),t(r,{prop:"category",label:"Категория Металла",width:"200"}),t(r,{prop:"subcategory",label:"Вид",width:"200"}),t(r,{label:"Цена за м.",width:"200"},{default:l(e=>[_(w(e.row.price.toLocaleString())+" сум ",1)]),_:1}),t(r,{label:"Статус",width:"170"},{default:l(e=>[_(w(e.row.available?"Активен":"Не активен"),1)]),_:1}),t(r,{label:"Операции",width:"260"},{default:l(e=>[t(c,{onClick:F=>u(a).updateMetalStatus(e.row.id,!e.row.available),type:e.row.available?"info":"success",icon:u(J)},{default:l(()=>[_(w(e.row.available?"Деактивировать":"Активировать"),1)]),_:2},1032,["onClick","type","icon"]),t(c,{onClick:F=>V(e.row.id,e.row.category,e.row.subcategory),type:"success",icon:u(K),circle:""},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data","border"]),t(x,{modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=e=>n.value=e),title:"Изменение цены",width:"500"},{footer:l(()=>[h("div",ee,[t(c,{onClick:s[1]||(s[1]=e=>{n.value=!1,M(o)?o.value="":o=""})},{default:l(()=>[_(" Отменить ")]),_:1}),t(c,{type:"primary",onClick:s[2]||(s[2]=e=>{n.value=!1,u(a).updateMetalPrice(u(g),u(o))})},{default:l(()=>[_(" Подтвердить ")]),_:1})])]),default:l(()=>[t(T,{model:p.form},{default:l(()=>[t(E,{label:"Цена","label-width":p.formLabelWidth},{default:l(()=>[t(A,{modelValue:u(o),"onUpdate:modelValue":s[0]||(s[0]=e=>M(o)?o.value=e:o=e),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])])):P("",!0),z(h("div",null,null,512),[[D,S.value,void 0,{fullscreen:!0,lock:!0}]])],64)}}};export{le as default};
